const btn_seguir=document.querySelector("#btn_seguir"),API_URL_VALIDAR_SEGUIR=`http://127.0.0.1:5000/seguindo/${JSON.parse(sessionStorage.getItem("usuario"))}`,API_URL_SEGUIR="http://127.0.0.1:5000/seguindo";window.addEventListener("load",(async e=>{const s=await fetch(API_URL_VALIDAR_SEGUIR);(await s.json()).forEach((e=>{if(e.seguido_id==JSON.parse(sessionStorage.getItem("usuario-clicado")))return btn_seguir.innerText="Deixar de seguir",void sessionStorage.setItem("seguindo",!0)}))})),btn_seguir.addEventListener("click",(async e=>{if(!JSON.parse(sessionStorage.getItem("usuario")))return void(window.location.href="cadastrar.html");const s={seguido_id:JSON.parse(sessionStorage.getItem("usuario-clicado")),seguidos_id:JSON.parse(sessionStorage.getItem("usuario"))};sessionStorage.getItem("seguindo")?(await fetch(API_URL_SEGUIR,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),btn_seguir.innerText="seguir",sessionStorage.removeItem("seguindo")):(await fetch(API_URL_SEGUIR,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),btn_seguir.innerText="deixar de seguir",sessionStorage.setItem("seguindo",!0))})),window.addEventListener("beforeunload",(e=>{sessionStorage.removeItem("seguindo")}));